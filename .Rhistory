} else {
state.data <- buy.state
col <- "~Type"
}
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
return(plot.out)
}
state.y.plot("WA", "Both")
state.y.plot("WA", "Both")
state.y.plot <- function(State, Year) {
if (Year == "Past") {
state.data <- buy.old[which(buy.old$State == State),]
col <- 'rgb(50,205,50)'
} else if (Year == "Recent") {
state.data <- buy.new[which(buy.new$State == State),]
col <- 'rgb(152,251,152)'
} else {
state.data <- buy.state
col <- ~Type
}
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
return(plot.out)
}
state.y.plot("WA", "Both")
runApp()
runApp('~/Desktop/INFO 498/info498-finalproject')
runApp('~/Desktop/INFO 498/info498-finalproject')
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
col <- c("rgb(50,205,50)", "rgb(50,205,50)")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
state.y.plot("CT", "All")
state.y.plot("CT", "All")
state.y.plot <- function(State, Year) {
if (Year == "Past") {
state.data <- buy.old[which(buy.old$State == State),]
col <- 'rgb(50,205,50)'
} else if (Year == "Recent") {
state.data <- buy.new[which(buy.new$State == State),]
col <- 'rgb(50,205,50)'
} else {
state.data <- buy.state
}
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
return(plot.out)
}
state.y.plot("CT", "All")
state.y.plot <- function(State, Year) {
if (Year == "Past") {
state.data <- buy.old[which(buy.old$State == State),]
col <- 'rgb(50,205,50)'
} else if (Year == "Recent") {
state.data <- buy.new[which(buy.new$State == State),]
col <- 'rgb(50,205,50)'
} else {
state.data <- buy.state
col <- 'rgb(150,205,250)'
}
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
return(plot.out)
}
state.y.plot("CT", "All")
state.y.plot <- function(State, Year) {
if (Year == "Past") {
state.data <- buy.old[which(buy.old$State == State),]
col <- 'rgb(50,205,50)'
} else if (Year == "Recent") {
state.data <- buy.new[which(buy.new$State == State),]
col <- 'rgb(50,205,50)'
} else {
state.data <- buy.state
col <- 'rgb(150,250,250)'
}
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
return(plot.out)
}
state.y.plot("CT", "All")
state.y.plot <- function(State, Year) {
if (Year == "Past") {
state.data <- buy.old[which(buy.old$State == State),]
col <- 'rgb(50,205,50)'
} else if (Year == "Recent") {
state.data <- buy.new[which(buy.new$State == State),]
col <- 'rgb(50,205,50)'
} else {
state.data <- buy.state
col <- 'rgb(250,250,50)'
}
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
return(plot.out)
}
state.y.plot("CT", "All")
state.y.plot("MA", "All")
state.y.plot("NJ", "All")
state.y.plot("MA", "All")
state.y.plot("MA", "All")
state.y.plot <- function(State, Year) {
if (Year == "Past") {
state.data <- buy.old[which(buy.old$State == State),]
col <- 'rgb(50,205,50)'
} else if (Year == "Recent") {
state.data <- buy.new[which(buy.new$State == State),]
col <- 'rgb(50,205,50)'
} else {
state.data <- buy.state[which(buy.new$State == State),]
col <- 'rgb(250,250,50)'
}
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
return(plot.out)
}
state.y.plot("MA", "All")
state.y.plot("CT", "All")
state.data <- buy.state[which(buy.new$State == "CT"),]
View(state.data)
state.data <- buy.state[which(buy.new$State == "MA"),]
View(state.data)
state.data <- buy.state[which(buy.new$State == "WA"),]
View(state.data)
View(buy.state)
state.y.plot <- function(State, Year) {
if (Year == "Past") {
state.data <- buy.old[which(buy.old$State == State),]
col <- 'rgb(50,205,50)'
} else if (Year == "Recent") {
state.data <- buy.new[which(buy.new$State == State),]
col <- 'rgb(50,205,50)'
} else {
state.data <- buy.state[which(buy.state$State == State),]
col <- 'rgb(250,250,50)'
}
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
return(plot.out)
}
state.data <- buy.state[which(buy.new$State == "WA"),]
state.y.plot <- function(State, Year) {
if (Year == "Past") {
state.data <- buy.old[which(buy.old$State == State),]
col <- 'rgb(50,205,50)'
} else if (Year == "Recent") {
state.data <- buy.new[which(buy.new$State == State),]
col <- 'rgb(50,205,50)'
} else {
state.data <- buy.state[which(buy.state$State == State),]
col <- 'rgb(250,250,50)'
}
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
return(plot.out)
}
state.y.plot("CT", "All")
state.y.plot("MA", "All")
state.y.plot("CT", "All")
state.y.plot("MA", "All")
state.y.plot("CT", "All")
state.y.plot("MA", "All")
state.y.plot <- function(State, Year) {
if (Year == "Past") {
state.data <- buy.old[which(buy.old$State == State),]
col <- 'rgb(50,205,50)'
} else if (Year == "Recent") {
state.data <- buy.new[which(buy.new$State == State),]
col <- 'rgb(50,205,50)'
} else {
state.data <- buy.state[which(buy.state$State == State),]
col <- 'rgb(79,148,205)'
}
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
return(plot.out)
}
state.y.plot("NJ", "All")
runApp()
runApp()
runApp()
runApp()
View(buy.data)
runApp()
buy.state$Year <- NA
for(i in 1:nrow(buy.data)){
if(endsWith(buy.state$Type[i], "09")) {
buy.state$Year[i] <- "Past"
} else {
if(endsWith(buy.state$Type[i], "09")) {
buy.state$Year[i] <- "Recent"
}
}
}
buy.state$Type <- substr(buy.state$Type, 1, nchar(buy.state$Type)-5)
buy.state <- gather(buy.data, "Type", "Value", -1)
library(plotly)
library(dplyr)
library(tidyr)
library(plyr)
library(ggplot2)
library(readxl)
# loading the data
stores.data <- read_excel("data/Stores-Accessibility.xlsx")
fm.data <- read_excel("data/Local-Accessibility.xlsx")
# selecting the needed variables
stores.data <- select(stores.data, c("State", "GROCPTH09", "GROCPTH14",
"SUPERCPTH09", "SUPERCPTH14", "CONVSPTH09",
"CONVSPTH14"))
fm.data <- select(fm.data, c("State", "FMRKTPTH09", "FMRKTPTH16"))
# finding average values by state
stores.mean <- aggregate(stores.data[-1], list(stores.data$State), mean)
fm.mean <- aggregate(fm.data[-1], list(fm.data$State), mean, na.rm=T)
# joining the datasets
buy.data <- left_join(stores.mean, fm.mean, by = "Group.1")
colnames(buy.data) <- c("State", "Grocery Stores 2009", "Grocery Stores 2014",
"Supercenters 2009", "Supercenters 2014", "Convenience Stores 2009",
"Convenience Stores 2014", "Farmers Market 2009", "Farmers Market 2016")
buy.state <- gather(buy.data, "Type", "Value", -1)
buy.state$Year <- NA
if(endsWith(buy.state$Type, "09")) {
buy.state$Year[i] <- "Past"
} else {
buy.state$Year[i] <- "Recent"
}
buy.state$Type <- substr(buy.state$Type, 1, nchar(buy.state$Type)-5)
View(buy.state)
buy.state <- gather(buy.data, "Type", "Value", -1)
buy.state$Year <- NA
for (i in 1:nrow(buy.state)) {
if(endsWith(buy.state$Type, "09")) {
buy.state$Year[i] <- "Past"
} else {
buy.state$Year[i] <- "Recent"
}
}
buy.state$Type <- substr(buy.state$Type, 1, nchar(buy.state$Type)-5)
state.y.plot <- function(State, Year) {
state.data <- buy.state[which(buy.state$State == State),]
if (Year != "Past" | Year != "Recent") {
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = ~Year))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'), barmode = "group")
} else {
state.data <- state.data[which(state.data$Year == Year),]
col <- 'rgb(50,205,50)'
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
}
return(plot.out)
}
state.y.plot("WA", "All")
state.y.plot <- function(State, Time) {
state.data <- buy.state[which(buy.state$State == State),]
if (Year != "Past" | Year != "Recent") {
plot.out <- ggplot(state.data, aes(fill=Year, y=Value, x=Type)) +
geom_bar(position="dodge", stat="identity")
} else {
state.data <- state.data[which(state.data$Year == Time),]
col <- 'rgb(50,205,50)'
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
}
return(plot.out)
}
state.y.plot("WA", "All")
state.y.plot <- function(State, Time) {
state.data <- buy.state[which(buy.state$State == State),]
if (Time != "Past" | Time != "Recent") {
plot.out <- ggplot(state.data, aes(fill=Year, y=Value, x=Type)) +
geom_bar(position="dodge", stat="identity")
} else {
state.data <- state.data[which(state.data$Year == Time),]
col <- 'rgb(50,205,50)'
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
}
return(plot.out)
}
state.y.plot("WA", "All")
buy.state <- gather(buy.data, "Type", "Value", -1)
buy.state$Year <- NA
for (i in 1:nrow(buy.state)) {
if(endsWith(buy.state$Type, "09")) {
buy.state$Year[i] <- "Past"
} else {
buy.state$Year[i] <- "Recent"
}
}
buy.state$Year <- NA
ifelse(endsWith(buy.state$Type, "09"), "Past","Recent")
buy.state$Year <- ifelse(endsWith(buy.state$Type, "09"), "Past","Recent")
buy.state$Type <- substr(buy.state$Type, 1, nchar(buy.state$Type)-5)
state.y.plot <- function(State, Time) {
state.data <- buy.state[which(buy.state$State == State),]
if (Time != "Past" | Time != "Recent") {
plot.out <- ggplot(state.data, aes(fill=Year, y=Value, x=Type)) +
geom_bar(position="dodge", stat="identity")
} else {
state.data <- state.data[which(state.data$Year == Time),]
col <- 'rgb(50,205,50)'
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
}
return(plot.out)
}
state.y.plot("WA", "All")
state.y.plot <- function(State, Time) {
state.data <- buy.state[which(buy.state$State == State),]
if (Time != "Past" | Time != "Recent") {
plot.out <- ggplot(state.data, aes(fill=Year, y=Value, x=Type)) +
geom_bar(position="dodge", stat="identity") +
geom_text(aes(label=Value), vjust=0)
} else {
state.data <- state.data[which(state.data$Year == Time),]
col <- 'rgb(50,205,50)'
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
}
return(plot.out)
}
state.y.plot("WA", "All")
state.y.plot <- function(State, Time) {
state.data <- buy.state[which(buy.state$State == State),]
if (Time != "Past" | Time != "Recent") {
plot.out <- ggplot(state.data, aes(fill=Year, y=Value, x=Type)) +
geom_bar(position="dodge", stat="identity") +
geom_text(aes(label=round(Value, 1)), vjust=0)
} else {
state.data <- state.data[which(state.data$Year == Time),]
col <- 'rgb(50,205,50)'
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
}
return(plot.out)
}
state.y.plot("WA", "All")
state.y.plot <- function(State, Time) {
state.data <- buy.state[which(buy.state$State == State),]
if (Time != "Past" | Time != "Recent") {
plot.out <- ggplot(state.data, aes(fill=Year, y=Value, x=Type)) +
geom_bar(position="dodge", stat="identity") +
geom_text(aes(label=round(Value, 3)))
} else {
state.data <- state.data[which(state.data$Year == Time),]
col <- 'rgb(50,205,50)'
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
}
return(plot.out)
}
state.y.plot("WA", "All")
state.y.plot <- function(State, Time) {
state.data <- buy.state[which(buy.state$State == State),]
if (Time != "Past" | Time != "Recent") {
plot.out <- ggplot(state.data, aes(fill=Year, y=Value, x=Type)) +
geom_bar(position="dodge", stat="identity") +
geom_text(aes(label=round(Value, 3), align = "center"))
} else {
state.data <- state.data[which(state.data$Year == Time),]
col <- 'rgb(50,205,50)'
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
}
return(plot.out)
}
state.y.plot("WA", "All")
state.y.plot("WA", "Past")
state.y.plot <- function(State, Time) {
state.data <- buy.state[which(buy.state$State == State),]
if (Time != "Past" | Time != "Recent") {
plot.out <- ggplot(state.data, aes(fill=Year, y=Value, x=Type)) +
geom_bar(position="dodge", stat="identity") +
geom_text(aes(label=round(Value, 3)))
} else {
state.data <- state.data[which(state.data$Year == Time),]
col <- 'rgb(50,205,50)'
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
}
return(plot.out)
}
state.y.plot("WA", "Past")
state.y.plot <- function(State, Time) {
state.data <- buy.state[which(buy.state$State == State),]
if (Time != "Past" & Time != "Recent") {
plot.out <- ggplot(state.data, aes(fill=Year, y=Value, x=Type)) +
geom_bar(position="dodge", stat="identity") +
geom_text(aes(label=round(Value, 3)))
} else {
state.data <- state.data[which(state.data$Year == Time),]
col <- 'rgb(50,205,50)'
plot.out <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
}
return(plot.out)
}
state.y.plot <- function(State, Time) {
state.data <- buy.state[which(buy.state$State == State),]
if (Time != "Past" & Time != "Recent") {
plot.a <- ggplot(state.data, aes(fill=Year, y=Value, x=Type)) +
geom_bar(position="dodge", stat="identity") +
geom_text(aes(label=round(Value, 3)))
} else {
state.data <- state.data[which(state.data$Year == Time),]
col <- 'rgb(50,205,50)'
plot.a <- plot_ly(state.data, x = ~Type, y = ~Value, type = 'bar',
marker = list(color = col))%>%
layout(title = ~paste("Comparison of Accessibility by Different Types of Stores"),
yaxis = list(title = '# Per 1,000 Pop.'),
xaxis = list(title = 'Types of Store'))
}
plot.out <- plot.a
return(plot.out)
}
state.y.plot("WA", "Past")
state.y.plot("WA", "Recent")
state.y.plot("WA", "Past")
state.y.plot("WA", "Recent")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
